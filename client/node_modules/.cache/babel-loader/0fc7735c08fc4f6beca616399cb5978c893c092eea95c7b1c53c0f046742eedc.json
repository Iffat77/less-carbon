{"ast":null,"code":"var _jsxFileName = \"/Users/iffathossain/iffatdev/projects/less-carbon/client/src/components/Likes.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { createLike, deleteLike, getLikesForArticle } from \"../services/likes.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Likes(_ref) {\n  _s();\n  let {\n    articleId,\n    user\n  } = _ref;\n  const [likes, setLikes] = useState([]);\n  const [isLiked, setIsLiked] = useState(false);\n  useEffect(() => {\n    const fetchLikes = async () => {\n      try {\n        const likesData = await getLikesForArticle(articleId);\n        setLikes(likesData);\n        const likedByUser = likesData.some(like => like.user === (user === null || user === void 0 ? void 0 : user._id));\n        /* user?._id is using Optional chaining, this can safely handle null or undefined */\n        setIsLiked(likedByUser);\n      } catch (error) {\n        console.error(\"Error fetching likes:\", error);\n      }\n    };\n    if (user) {\n      fetchLikes();\n    }\n  }, [articleId, user]);\n  const handleLike = async () => {\n    if (isLiked) {\n      try {\n        await deleteLike(articleId);\n        setIsLiked(false);\n        //setting likes to exclude the matching userid\n        setLikes(prevLikes => prevLikes.filter(like => like.user !== user._id));\n      } catch (error) {\n        console.error(\"Error deleting like:\", error);\n      }\n    } else {\n      try {\n        const newLike = await createLike(articleId);\n        setIsLiked(true);\n        setLikes(prevLikes => [...prevLikes, newLike]);\n      } catch (error) {\n        console.error(\"Error creating like:\", error);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleLike,\n      children: isLiked ? \"Unlike\" : \"Like\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n      children: [likes.length, \" Likes\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 5\n  }, this);\n}\n_s(Likes, \"4uH0rDKOJq159jyNHztXBYblsvw=\");\n_c = Likes;\nexport default Likes;\nvar _c;\n$RefreshReg$(_c, \"Likes\");","map":{"version":3,"names":["React","useEffect","useState","createLike","deleteLike","getLikesForArticle","jsxDEV","_jsxDEV","Likes","_ref","_s","articleId","user","likes","setLikes","isLiked","setIsLiked","fetchLikes","likesData","likedByUser","some","like","_id","error","console","handleLike","prevLikes","filter","newLike","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","length","_c","$RefreshReg$"],"sources":["/Users/iffathossain/iffatdev/projects/less-carbon/client/src/components/Likes.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { createLike, deleteLike, getLikesForArticle } from \"../services/likes.js\";\n\nfunction Likes({ articleId, user }) {\n  const [likes, setLikes] = useState([]);\n  const [isLiked, setIsLiked] = useState(false);\n  \n  useEffect(() => {\n    const fetchLikes = async () => {\n      try {\n        const likesData = await getLikesForArticle(articleId);\n        setLikes(likesData);\n        const likedByUser = likesData.some((like) => like.user === user?._id);\n         /* user?._id is using Optional chaining, this can safely handle null or undefined */\n        setIsLiked(likedByUser);\n      } catch (error) {\n        console.error(\"Error fetching likes:\", error);\n      }\n    };\n\n    if (user) {\n      fetchLikes();\n    }\n  }, [articleId, user]);\n\n  const handleLike = async () => {\n    if (isLiked) {\n      try {\n        await deleteLike(articleId);\n        setIsLiked(false);\n        //setting likes to exclude the matching userid\n        setLikes((prevLikes) =>\n          prevLikes.filter((like) => like.user !== user._id)\n        );\n      } catch (error) {\n        console.error(\"Error deleting like:\", error);\n      }\n    } else {\n      try {\n        const newLike = await createLike(articleId);\n        setIsLiked(true);\n        setLikes((prevLikes) => [...prevLikes, newLike]);\n      } catch (error) {\n        console.error(\"Error creating like:\", error);\n      }\n    }\n  };\n\n  return (\n    <div>\n      <button onClick={handleLike}>{isLiked ? \"Unlike\" : \"Like\"}</button>\n      <span>{likes.length} Likes</span>\n    </div>\n  );\n}\n\nexport default Likes;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,UAAU,EAAEC,UAAU,EAAEC,kBAAkB,QAAQ,sBAAsB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAElF,SAASC,KAAKA,CAAAC,IAAA,EAAsB;EAAAC,EAAA;EAAA,IAArB;IAAEC,SAAS;IAAEC;EAAK,CAAC,GAAAH,IAAA;EAChC,MAAM,CAACI,KAAK,EAAEC,QAAQ,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EAE7CD,SAAS,CAAC,MAAM;IACd,MAAMgB,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI;QACF,MAAMC,SAAS,GAAG,MAAMb,kBAAkB,CAACM,SAAS,CAAC;QACrDG,QAAQ,CAACI,SAAS,CAAC;QACnB,MAAMC,WAAW,GAAGD,SAAS,CAACE,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACT,IAAI,MAAKA,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEU,GAAG,EAAC;QACpE;QACDN,UAAU,CAACG,WAAW,CAAC;MACzB,CAAC,CAAC,OAAOI,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC/C;IACF,CAAC;IAED,IAAIX,IAAI,EAAE;MACRK,UAAU,CAAC,CAAC;IACd;EACF,CAAC,EAAE,CAACN,SAAS,EAAEC,IAAI,CAAC,CAAC;EAErB,MAAMa,UAAU,GAAG,MAAAA,CAAA,KAAY;IAC7B,IAAIV,OAAO,EAAE;MACX,IAAI;QACF,MAAMX,UAAU,CAACO,SAAS,CAAC;QAC3BK,UAAU,CAAC,KAAK,CAAC;QACjB;QACAF,QAAQ,CAAEY,SAAS,IACjBA,SAAS,CAACC,MAAM,CAAEN,IAAI,IAAKA,IAAI,CAACT,IAAI,KAAKA,IAAI,CAACU,GAAG,CACnD,CAAC;MACH,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC9C;IACF,CAAC,MAAM;MACL,IAAI;QACF,MAAMK,OAAO,GAAG,MAAMzB,UAAU,CAACQ,SAAS,CAAC;QAC3CK,UAAU,CAAC,IAAI,CAAC;QAChBF,QAAQ,CAAEY,SAAS,IAAK,CAAC,GAAGA,SAAS,EAAEE,OAAO,CAAC,CAAC;MAClD,CAAC,CAAC,OAAOL,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC9C;IACF;EACF,CAAC;EAED,oBACEhB,OAAA;IAAAsB,QAAA,gBACEtB,OAAA;MAAQuB,OAAO,EAAEL,UAAW;MAAAI,QAAA,EAAEd,OAAO,GAAG,QAAQ,GAAG;IAAM;MAAAgB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAS,CAAC,eACnE3B,OAAA;MAAAsB,QAAA,GAAOhB,KAAK,CAACsB,MAAM,EAAC,QAAM;IAAA;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC9B,CAAC;AAEV;AAACxB,EAAA,CAnDQF,KAAK;AAAA4B,EAAA,GAAL5B,KAAK;AAqDd,eAAeA,KAAK;AAAC,IAAA4B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}